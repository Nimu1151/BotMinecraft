name: FreeGameHost Auto Extend

on:
  # Ejecutar cada 6 horas
  schedule:
    - cron: '0 */6 * * *'
  
  # Permitir ejecuciรณn manual desde GitHub
  workflow_dispatch:

jobs:
  extend-server-time:
    runs-on: ubuntu-latest
    
    steps:
      - name: ๐ฅ Checkout repository
        uses: actions/checkout@v4
      
      - name: ๐ข Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '20'
          cache: 'npm'
      
      - name: ๐ฆ Install dependencies
        run: |
          npm install
      
      - name: ๐ช Decode cookies from secrets
        env:
          COOKIES_BASE64: ${{ secrets.COOKIES_BASE64 }}
        run: |
          if [ -z "$COOKIES_BASE64" ]; then
            echo "โ ERROR: Secret COOKIES_BASE64 no encontrado"
            echo "Por favor, configura el secret en Settings โ Secrets โ Actions"
            exit 1
          fi
          echo "$COOKIES_BASE64" | base64 -d > cookies.json
          echo "โ Cookies decodificadas correctamente"
      
      - name: ๐ค Run bot
        run: |
          echo "๐ Iniciando bot..."
          node bot.js
        timeout-minutes: 5
      
      - name: โ Success notification
        if: success()
        run: |
          echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
          echo "โ BOT EJECUTADO EXITOSAMENTE"
          echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
          echo "โฐ Tiempo: $(date)"
          echo "๐ Servidor extendido por 6 horas mรกs"
      
      - name: โ Failure notification
        if: failure()
        run: |
          echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
          echo "โ ERROR EN LA EJECUCIรN"
          echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
          echo "โฐ Tiempo: $(date)"
          echo "๐ก Revisa los logs arriba para mรกs detalles"
